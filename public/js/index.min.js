/*! pic-vote 2014-03-18 */
var app=angular.module("app",["infinite-scroll"]);app.controller("Imgs",["$scope","$http",function(a,b){a.imgs_data=window.imgs_data,a.vote=function(a){b.get("isVote").success(function(c){if("true"===c)alert("你已投票");else if(confirm("确定要投这张图片?")){b.post("vote",$.param({imgs_id:a}),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(a){"true"===a?(alert("投票成功"),location.reload()):alert("投票失败")})}})},a.load=function(c){if(imgs_index<a.imgs_data.length){var d=a.imgs_data[imgs_index++];b.get("vote_count/"+d.id).success(function(b){d.vote_count=b,a.imgs[c].push(d)})}};var c,d=3;for(a.imgs=new Array(d),c=0;d>c;++c)a.imgs[c]=[],a.load(c);for(c=0;d>c;++c)a.load(c);a.loadMore=function(b){a.load(b)}}]),$(function(){$(".fancybox").fancybox()});